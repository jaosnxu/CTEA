// ============================================================================
// CTEA Platform - Complete Prisma Schema
// ============================================================================
// Architecture: PostgreSQL 14+ with Prisma ORM
// Audit Event: M3.4-GLOBAL-COMP-002A
// Migration Date: 2026-01-12
// Total Tables: 74
// ============================================================================

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

// ============================================================================
// Enums
// ============================================================================

enum OrganizationLevel {
  HQ
  ORG
  STORE
}

enum OrganizationStatus {
  ACTIVE
  INACTIVE
  SUSPENDED
}

enum AdminUserRole {
  HQ_ADMIN
  HQ_OPERATOR
  ORG_ADMIN
  ORG_OPERATOR
  STORE_MANAGER
  STORE_STAFF
}

enum AdminUserStatus {
  ACTIVE
  INACTIVE
  SUSPENDED
  PENDING_ACTIVATION
}

enum AuditAction {
  INSERT
  UPDATE
  DELETE
}

enum OperatorType {
  ADMIN
  USER
  SYSTEM
  API
}

enum ConfigValueType {
  STRING
  NUMBER
  BOOLEAN
  JSON
  ARRAY
}

enum AccountType {
  DEPOSIT
  REVENUE
  SETTLEMENT
}

enum AccountStatus {
  ACTIVE
  FROZEN
  CLOSED
}

enum SettlementCycle {
  DAILY
  WEEKLY
  MONTHLY
}

enum SettlementStatus {
  PENDING
  PROCESSING
  SETTLED
  CANCELLED
}

enum BatchStatus {
  DRAFT
  CONFIRMED
  PROCESSING
  COMPLETED
  CANCELLED
}

enum RefundStatus {
  PENDING
  APPROVED
  REJECTED
  PROCESSING
  COMPLETED
  FAILED
}




enum AddressType {
  HOME
  WORK
  OTHER
}
enum EntityType {
  IP
  PHONE
  DEVICE
  USER
}
enum FenceType {
  CIRCLE
  POLYGON
}
enum MenuType {
  BREAKFAST
  LUNCH
  DINNER
  LATE_NIGHT
  ALL_DAY
}
enum Priority {
  LOW
  MEDIUM
  HIGH
  URGENT
}
enum ReportType {
  DAILY_SUMMARY
  WEEKLY_REVIEW
  MONTHLY_ANALYSIS
  CUSTOM
}
enum Status {
  NEW
  VIEWED
  ACCEPTED
  REJECTED
  IMPLEMENTED
}
enum SuggestionType {
  PRICING
  INVENTORY
  MARKETING
  OPERATION
}
enum TaskType {
  POST
  VIDEO
  REVIEW
  REFERRAL
}
enum TokenType {
  TOTP
  HARDWARE
}
enum TrustLevel {
  HIGH_RISK
  NORMAL
  TRUSTED
  VIP
}
enum UserType {
  FAN
  INFLUENCER
  STAFF
  ADMIN
}



// ============================================================================
// Models
// ============================================================================
/// 组织表 - 三级架构：总部(HQ) → 组织(ORG) → 门店(STORE)
model Organization {
  id        String              @id @default(uuid())
  parentId  String?
  parent    Organization?       @relation("OrganizationHierarchy", fields: [parentId], references: [id])
  children  Organization[]      @relation("OrganizationHierarchy")
  
  code      String              @unique @db.VarChar(50)
  name      Json                // 多语言名称 {ru, zh, en}
  level     OrganizationLevel
  timezone  String              @default("Europe/Moscow") @db.VarChar(50)
  currency  String              @default("RUB") @db.VarChar(10)
  status    OrganizationStatus  @default(ACTIVE)
  config    Json?               // 组织级配置
  
  createdAt DateTime            @default(now())
  updatedAt DateTime            @updatedAt
  createdBy String?
  updatedBy String?
  
  // Relations
  stores              Store[]
  adminUsers          AdminUser[]
  depositAccounts     DepositAccount[]
  settlementRules     SettlementRule[]
  crossStoreLedgers   CrossStoreLedger[]
  settlementBatches   SettlementBatch[]
  systemConfigs       SystemConfig[]
  auditLogs           AuditLog[]
  
  @@index([parentId])
  @@map("organizations")
}

/// 门店表
model Store {
  id              String              @id @default(uuid())
  orgId           String
  organization    Organization        @relation(fields: [orgId], references: [id])
  
  code            String              @db.VarChar(50)
  name            Json                // 多语言名称 {ru, zh, en}
  address         Json?               // 多语言地址 {ru, zh, en}
  phone           String?             @db.VarChar(20)
  email           String?             @db.VarChar(255)
  timezone        String              @default("Europe/Moscow") @db.VarChar(50)
  latitude        Decimal?            @db.Decimal(10, 7)
  longitude       Decimal?            @db.Decimal(10, 7)
  businessHours   Json?               // 营业时间配置
  cutoffHour      Int                 @default(5)
  iikoTerminalId  String?             @db.VarChar(100)
  status          OrganizationStatus  @default(ACTIVE)
  config          Json?               // 门店级配置
  
  createdAt       DateTime            @default(now())
  updatedAt       DateTime            @updatedAt
  createdBy       String?
  updatedBy       String?
  
    // Relations
    adminUsers            AdminUser[]
    depositAccounts       DepositAccount[]
    crossStoreLedgersIssue CrossStoreLedger[] @relation("IssueStore")
    crossStoreLedgersRedeem CrossStoreLedger[] @relation("RedeemStore")
    systemConfigs         SystemConfig[]
    orders                Orders[]
  
    @@unique([orgId, code])
  @@index([orgId])
  @@map("stores")
}

/// 管理员用户表
model AdminUser {
  id              String            @id @default(uuid())
  orgId           String?
  organization    Organization?     @relation(fields: [orgId], references: [id])
  storeId         String?
  store           Store?            @relation(fields: [storeId], references: [id])
  
  username        String            @unique @db.VarChar(50)
  passwordHash    String            @db.VarChar(255)
  phone           String?           @db.VarChar(20)
  phoneVerified   Boolean           @default(false)
  email           String?           @db.VarChar(255)
  name            Json?             // 多语言名称 {ru, zh, en}
  role            AdminUserRole
  permissions     Json?             // 权限列表
  languagePref    String            @default("ru") @db.VarChar(10)
  status          AdminUserStatus   @default(PENDING_ACTIVATION)
  lastLoginAt     DateTime?
  lastLoginIp     String?           @db.VarChar(45)
  
  createdAt       DateTime          @default(now())
  updatedAt       DateTime          @updatedAt
  createdBy       String?
  updatedBy       String?
  
  @@index([orgId])
  @@index([storeId])
  @@map("admin_users")
}

/// 审计日志表 - Diff Log（不可篡改）+ SHA-256 链式审计
model AuditLog {
  id            BigInt          @id @default(autoincrement())
  orgId         String?
  organization  Organization?   @relation(fields: [orgId], references: [id])
  
  tableName     String          @db.VarChar(100)
  recordId      String          @db.VarChar(100)
  action        AuditAction
  diffBefore    Json?           // 修改前数据
  diffAfter     Json?           // 修改后数据
  operatorId    String?
  operatorType  OperatorType?
  operatorName  String?         @db.VarChar(100)
  ipAddress     String?         @db.VarChar(45)
  userAgent     String?
  reason        String?
  
  // SHA-256 链式审计字段（M3.4-GLOBAL-COMP-002 要求）
  eventId       String?         @unique @db.VarChar(100)
  previousHash  String?         @db.VarChar(64)
  sha256Hash    String?         @db.VarChar(64)
  
  createdAt     DateTime        @default(now())
  
  @@index([orgId])
  @@index([tableName])
  @@index([tableName, recordId])
  @@index([createdAt])
  @@index([eventId])
  @@map("audit_logs")
}

/// 系统配置表 - 参数化配置（严禁 Hardcode）
model SystemConfig {
  id            String          @id @default(uuid())
  orgId         String?
  organization  Organization?   @relation(fields: [orgId], references: [id])
  storeId       String?
  store         Store?          @relation(fields: [storeId], references: [id])
  
  configKey     String          @db.VarChar(100)
  configValue   Json
  valueType     ConfigValueType
  description   Json?           // 多语言描述 {ru, zh, en}
  isEditable    Boolean         @default(true)
  
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt
  createdBy     String?
  updatedBy     String?
  
  @@unique([orgId, storeId, configKey])
  @@map("system_configs")
}

/// 权限规则表
model PermissionRule {
  id          String    @id @default(uuid())
  role        String    @db.VarChar(50)
  resource    String    @db.VarChar(100)
  action      String    @db.VarChar(50)
  conditions  Json?     // 条件表达式
  isAllowed   Boolean   @default(true)
  
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  createdBy   String?
  updatedBy   String?
  
  @@index([resource])
  @@map("permission_rules")
}

// ============================================================================
// 第二章：财务模块 (Finance)
// ============================================================================

/// 虚拟保证金账户表
model DepositAccount {
  id            String          @id @default(uuid())
  orgId         String
  organization  Organization    @relation(fields: [orgId], references: [id])
  storeId       String
  store         Store           @relation(fields: [storeId], references: [id])
  
  accountType   AccountType     @default(DEPOSIT)
  balance       Decimal         @default(0.00) @db.Decimal(15, 2)
  frozenAmount  Decimal         @default(0.00) @db.Decimal(15, 2)
  currency      String          @default("RUB") @db.VarChar(10)
  status        AccountStatus   @default(ACTIVE)
  
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt
  createdBy     String?
  updatedBy     String?
  
  @@unique([storeId, accountType])
  @@index([orgId])
  @@map("deposit_accounts")
}

/// 结算规则表
model SettlementRule {
  id                    String            @id @default(uuid())
  orgId                 String?
  organization          Organization?     @relation(fields: [orgId], references: [id])
  
  ruleCode              String            @db.VarChar(50)
  name                  Json              // 多语言名称
  delayDays             Int               @default(7)
  autoRefundThreshold   Decimal           @default(0.30) @db.Decimal(5, 2)
  settlementCycle       SettlementCycle   @default(WEEKLY)
  isActive              Boolean           @default(true)
  
  createdAt             DateTime          @default(now())
  updatedAt             DateTime          @updatedAt
  createdBy             String?
  updatedBy             String?
  
  @@map("settlement_rules")
}

/// 跨店对账表 - A店发券B店核销
model CrossStoreLedger {
  id                BigInt            @id @default(autoincrement())
  orgId             String
  organization      Organization      @relation(fields: [orgId], references: [id])
  orderId           BigInt
  couponId          String
  userCouponId      String
  issueStoreId      String
  issueStore        Store             @relation("IssueStore", fields: [issueStoreId], references: [id])
  redeemStoreId     String
  redeemStore       Store             @relation("RedeemStore", fields: [redeemStoreId], references: [id])
  
  amount            Decimal           @db.Decimal(15, 2)
  settlementStatus  SettlementStatus  @default(PENDING)
  settlementBatchId String?
  settlementBatch   SettlementBatch?  @relation(fields: [settlementBatchId], references: [id])
  settledAt         DateTime?
  businessDate      String?           @db.VarChar(10)
  
  createdAt         DateTime          @default(now())
  updatedAt         DateTime          @updatedAt
  createdBy         String?
  updatedBy         String?
  
  @@index([orgId])
  @@index([orderId])
  @@index([issueStoreId])
  @@index([redeemStoreId])
  @@index([settlementStatus])
  @@map("cross_store_ledger")
}

/// 结算批次表
model SettlementBatch {
  id            String              @id @default(uuid())
  orgId         String
  organization  Organization        @relation(fields: [orgId], references: [id])
  
  batchNo       String              @unique @db.VarChar(50)
  periodStart   DateTime
  periodEnd     DateTime
  totalAmount   Decimal             @default(0.00) @db.Decimal(15, 2)
  netAmount     Decimal             @default(0.00) @db.Decimal(15, 2)
  recordCount   Int                 @default(0)
  status        BatchStatus         @default(DRAFT)
  confirmedBy   String?
  confirmedAt   DateTime?
  completedAt   DateTime?
  
  createdAt     DateTime            @default(now())
  updatedAt     DateTime            @updatedAt
  createdBy     String?
  updatedBy     String?
  
  // Relations
  crossStoreLedgers CrossStoreLedger[]
  
  @@map("settlement_batches")
}

/// 退款记录表
model RefundRecord {
  id              String        @id @default(uuid())
  orderId         String
  userId          String
  amount          Decimal       @db.Decimal(15, 2)
  reason          String?
  status          RefundStatus  @default(PENDING)
  approvedBy      String?
  approvedAt      DateTime?
  completedAt     DateTime?
  refundMethod    String?       @db.VarChar(50)
  refundReference String?       @db.VarChar(100)
  
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
  createdBy       String?
  updatedBy       String?
  
  @@index([orderId])
  @@index([userId])
  @@index([status])
  @@map("refund_records")
}

/// 财务报表表
model FinancialReport {
  id            String    @id @default(uuid())
  reportType    String    @db.VarChar(50)
  periodStart   DateTime
  periodEnd     DateTime
  reportData    Json      // 报表数据
  generatedBy   String?
  generatedAt   DateTime  @default(now())
  
  createdAt     DateTime  @default(now())
  
  @@index([reportType])
  @@index([periodStart, periodEnd])
  @@map("financial_reports")
}


// ============================================================================
// Auto-generated Models (Remaining 62 tables)
// ============================================================================


/// Campaigns
model Campaigns {
  id                   String @id @default(uuid())
  orgId                Int
  code                 String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("campaigns")
}
/// Coupons
model Coupons {
  id                   String @id @default(uuid())
  orgId                Int
  campaignId           Int?
  code                 String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("coupons")
}
/// Usercoupons
model Usercoupons {
  id                   String @id @default(uuid())
  userId               Int
  couponId             Int
  issueStoreId         Int
  couponCode           String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("user_coupons")
}
/// Sduilayouts
model Sduilayouts {
  id                   String @id @default(uuid())
  orgId                Int
  layoutCode           String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("sdui_layouts")
}
/// Geofencerules
model Geofencerules {
  id                   String @id @default(uuid())
  orgId                Int
  name                 Json
  fenceType            FenceType
  centerLat            Decimal? @db.Decimal(10, 7)
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("geo_fence_rules")
}
/// Weathertriggers
model Weathertriggers {
  id                   String @id @default(uuid())
  orgId                Int
  name                 Json
  weatherCondition     Json?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("weather_triggers")
}
/// Categories
model Categories {
  id                   String @id @default(uuid())
  orgId                Int
  parentId             Int?
  code                 String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("categories")
}
/// Products
model Products {
  id                   String @id @default(uuid())
  orgId                Int
  categoryId           Int
  code                 String?
  name                 String?  @db.VarChar(200)
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  
  orderItems           Orderitems[]
  
  @@map("products")
}
/// Skuattributes
model Skuattributes {
  id                   String @id @default(uuid())
  orgId                Int
  attributeCode        String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("sku_attributes")
}
/// Productskus
model Productskus {
  id                   String @id @default(uuid())
  productId            Int
  skuCode              String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("product_skus")
}
/// Storeprices
model Storeprices {
  id                   String @id @default(uuid())
  storeId              Int
  productId            Int
  price                Decimal? @db.Decimal(15, 2)
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("store_prices")
}
/// Timeslotmenus
model Timeslotmenus {
  id                   String @id @default(uuid())
  orgId                Int
  storeId              Int?
  name                 Json
  menuType             MenuType
  startTime            String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("time_slot_menus")
}
/// Iikoshadowmenu
model Iikoshadowmenu {
  id                   String @id @default(uuid())
  orgId                Int
  productId            Int
  iikoProductId        String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("iiko_shadow_menu")
}
/// Pricechangelogs
model Pricechangelogs {
  id                   BigInt @id @default(autoincrement())
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("price_change_logs")
}
/// Datapipelines
model Datapipelines {
  id                   String @id @default(uuid())
  orgId                Int
  pipelineCode         String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("data_pipelines")
}
/// Aireports
model Aireports {
  id                   String @id @default(uuid())
  orgId                Int
  storeId              Int?
  reportType           ReportType
  reportDate           String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("ai_reports")
}
/// Translationreviews
model Translationreviews {
  id                   String @id @default(uuid())
  orgId                Int
  sourceType           String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("translation_reviews")
}
/// Aisuggestions
model Aisuggestions {
  id                   String @id @default(uuid())
  orgId                Int
  storeId              Int?
  suggestionType       SuggestionType
  title                Json
  content              Json
  priority             Priority? @default(MEDIUM)
  status               Status? @default(NEW)
  actionedBy           Int?
  actionedAt           DateTime?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("ai_suggestions")
}
/// Vectorembeddings
model Vectorembeddings {
  id                   BigInt @id @default(autoincrement())
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("vector_embeddings")
}
/// Llmcalllogs
model Llmcalllogs {
  id                   BigInt @id @default(autoincrement())
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("llm_call_logs")
}
/// Orders
model Orders {
  id                   BigInt @id @default(autoincrement())
  orderNumber          String?  @db.VarChar(50)
  storeId              String?
  store                Store?   @relation(fields: [storeId], references: [id])
  userId               String?
  user                 Users?   @relation(fields: [userId], references: [id])
  status               String   @default("pending") @db.VarChar(50)
  totalAmount          Decimal? @db.Decimal(10, 2)
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  
  orderItems           Orderitems[]
  
  @@map("orders")
}
/// Orderitems
model Orderitems {
  id                   BigInt @id @default(autoincrement())
  orderId              BigInt?
  order                Orders?  @relation(fields: [orderId], references: [id])
  productId            String?
  product              Products? @relation(fields: [productId], references: [id])
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("order_items")
}
/// Orderdiscounts
model Orderdiscounts {
  id                   String @id @default(uuid())
  orderId              BigInt?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("order_discounts")
}
/// Reviews
model Reviews {
  id                   String @id @default(uuid())
  orgId                Int
  storeId              Int
  orderId              BigInt?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("reviews")
}
/// Reviewimages
model Reviewimages {
  id                   String @id @default(uuid())
  reviewId             Int
  imageUrl             String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("review_images")
}
/// Mallproducts
model Mallproducts {
  id                   String @id @default(uuid())
  orgId                Int
  categoryId           Int?
  code                 String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("mall_products")
}
/// Mallorders
model Mallorders {
  id                   BigInt @id @default(autoincrement())
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("mall_orders")
}
/// Mallorderitems
model Mallorderitems {
  id                   BigInt @id @default(autoincrement())
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("mall_order_items")
}
/// Mallinventory
model Mallinventory {
  id                   String @id @default(uuid())
  productId            Int
  warehouseId          Int?
  quantity             Int? @default(0)
  reservedQuantity     Int? @default(0)
  lowStockThreshold    Int? @default(10)
  updatedAt            DateTime @default(now()) @updatedAt
  createdAt            DateTime @default(now())
  createdBy            String?
  updatedBy            String?
  @@map("mall_inventory")
}
/// Logisticstracking
model Logisticstracking {
  id                   BigInt @id @default(autoincrement())
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("logistics_tracking")
}
/// Influencers
model Influencers {
  id                   String @id @default(uuid())
  orgId                Int
  userId               Int
  code                 String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("influencers")
}
/// Influencertasks
model Influencertasks {
  id                   String @id @default(uuid())
  orgId                Int
  name                 Json
  description          Json?
  taskType             TaskType
  requirements         Json?
  reward               Decimal? @db.Decimal(15, 2)
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("influencer_tasks")
}
/// Tasksubmissions
model Tasksubmissions {
  id                   String @id @default(uuid())
  taskId               Int
  influencerId         Int
  submissionUrl        String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("task_submissions")
}
/// Influencercommissions
model Influencercommissions {
  id                   BigInt @id @default(autoincrement())
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("influencer_commissions")
}
/// Withdrawalrequests
model Withdrawalrequests {
  id                   String @id @default(uuid())
  influencerId         Int
  amount               Decimal? @db.Decimal(15, 2)
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("withdrawal_requests")
}
/// Referrallinks
model Referrallinks {
  id                   String @id @default(uuid())
  influencerId         Int
  linkCode             String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("referral_links")
}
/// Chatsessions
model Chatsessions {
  id                   BigInt @id @default(autoincrement())
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("chat_sessions")
}
/// Chatmessages
model Chatmessages {
  id                   BigInt @id @default(autoincrement())
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("chat_messages")
}
/// Aiintents
model Aiintents {
  id                   String @id @default(uuid())
  intentCode           String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("ai_intents")
}
/// Quickreplies
model Quickreplies {
  id                   String @id @default(uuid())
  orgId                Int
  category             String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("quick_replies")
}
/// Faqentries
model Faqentries {
  id                   String @id @default(uuid())
  orgId                Int
  category             String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("faq_entries")
}
/// Telegrambotconfig
model Telegrambotconfig {
  id                   String @id @default(uuid())
  orgId                Int
  botToken             String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("telegram_bot_config")
}
/// Users
model Users {
  id                   String @id @default(uuid())
  openId               String?
  phone                String?  @db.VarChar(20)
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  
  orders               Orders[]
  
  @@map("users")
}
/// Useraddresses
model Useraddresses {
  id                   String @id @default(uuid())
  userId               Int
  addressType          AddressType? @default(HOME)
  recipientName        String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("user_addresses")
}
/// Userpoints
model Userpoints {
  id                   BigInt @id @default(autoincrement())
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("user_points")
}
/// Giftcards
model Giftcards {
  id                   String @id @default(uuid())
  orgId                Int
  cardCode             String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("gift_cards")
}
/// Smsproviders
model Smsproviders {
  id                   String @id @default(uuid())
  providerCode         String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("sms_providers")
}
/// Smsverificationlogs
model Smsverificationlogs {
  id                   BigInt @id @default(autoincrement())
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("sms_verification_logs")
}
/// Phonebindings
model Phonebindings {
  id                   String @id @default(uuid())
  userId               Int
  userType             UserType
  phone                String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("phone_bindings")
}
/// Sensitiveactionlogs
model Sensitiveactionlogs {
  id                   BigInt @id @default(autoincrement())
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("sensitive_action_logs")
}
/// Securitytokens
model Securitytokens {
  id                   String @id @default(uuid())
  adminUserId          Int
  tokenType            TokenType
  secretKey            String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("security_tokens")
}
/// Verificationrules
model Verificationrules {
  id                   String @id @default(uuid())
  ruleCode             String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("verification_rules")
}
/// Riskcontrollogs
model Riskcontrollogs {
  id                   BigInt @id @default(autoincrement())
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("risk_control_logs")
}
/// Captchaconfigs
model Captchaconfigs {
  id                   String @id @default(uuid())
  provider             String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("captcha_configs")
}
/// Captchaverifylogs
model Captchaverifylogs {
  id                   BigInt @id @default(autoincrement())
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("captcha_verify_logs")
}
/// Securityrules
model Securityrules {
  id                   String @id @default(uuid())
  ruleCode             String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("security_rules")
}
/// Securityauditlogs
model Securityauditlogs {
  id                   BigInt @id @default(autoincrement())
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("security_audit_logs")
}
/// Blockedentities
model Blockedentities {
  id                   String @id @default(uuid())
  entityType           EntityType
  entityValue          String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("blocked_entities")
}
/// Translations
model Translations {
  id                   String @id @default(uuid())
  key                  String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("translations")
}
/// Translationauditlog
model Translationauditlog {
  id                   String @id @default(uuid())
  translationId        Int
  action               String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("translation_audit_log")
}
/// Offlineredemptionqueue
model Offlineredemptionqueue {
  id                   BigInt @id @default(autoincrement())
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("offline_redemption_queue")
}
/// Usertrustscores
model Usertrustscores {
  id                   String @id @default(uuid())
  userId               Int
  trustScore           Int? @default(0)
  trustLevel           TrustLevel? @default(NORMAL)
  registrationDays     Int? @default(0)
  totalOrders          Int? @default(0)
  totalSpent           Decimal? @db.Decimal(15, 2)
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  createdBy            String?
  updatedBy            String?
  @@map("user_trust_scores")
}
