# ============================================================================
# CTEA Platform - Production Environment Configuration
# ============================================================================
# 
# FROZEN BASELINE - DO NOT MODIFY WITHOUT CHANGE APPROVAL
# Version: 1.0.0
# Frozen Date: 2026-01-06
# Commit: db255023
#
# ============================================================================

# ----------------------------------------------------------------------------
# DATABASE CONFIGURATION (REQUIRED)
# ----------------------------------------------------------------------------

# PostgreSQL connection string with SSL
# Format: postgresql://user:password@host:port/database?sslmode=require
DATABASE_URL=postgresql://ctea_prod:CHANGE_ME@db.example.com:5432/ctea_production?sslmode=require

# SSL Configuration - MANDATORY FOR PRODUCTION
# ⚠️ SECURITY: These values are FROZEN and must not be weakened
DATABASE_SSL=true
DATABASE_SSL_REJECT_UNAUTHORIZED=true

# ⛔ PROHIBITED: Setting DATABASE_SSL_REJECT_UNAUTHORIZED=false in production
# This would disable certificate verification and expose the system to MITM attacks
# Only use false in development/staging with self-signed certificates

# For custom CA certificates (optional, for private PKI)
# NODE_EXTRA_CA_CERTS=/etc/ssl/certs/custom-ca.crt

# ----------------------------------------------------------------------------
# APPLICATION CONFIGURATION
# ----------------------------------------------------------------------------

NODE_ENV=production
PORT=3000

# JWT Secret - MUST be a strong random string (min 32 characters)
JWT_SECRET=CHANGE_ME_TO_STRONG_RANDOM_STRING_MIN_32_CHARS

# Session configuration
SESSION_SECRET=CHANGE_ME_TO_ANOTHER_STRONG_RANDOM_STRING

# ----------------------------------------------------------------------------
# REDIS CONFIGURATION (REQUIRED FOR PRODUCTION)
# ----------------------------------------------------------------------------

# Redis connection for session storage and caching
REDIS_URL=redis://redis.example.com:6379

# Redis password (if authentication enabled)
# REDIS_PASSWORD=CHANGE_ME

# ----------------------------------------------------------------------------
# IIKO INTEGRATION
# ----------------------------------------------------------------------------

# IIKO API credentials
IIKO_API_URL=https://api.iiko.ru
IIKO_API_LOGIN=CHANGE_ME
IIKO_ORGANIZATION_ID=CHANGE_ME

# Sync configuration
IIKO_SYNC_ENABLED=true
IIKO_SYNC_INTERVAL=300000
IIKO_RESPECT_MANUAL_OVERRIDE=true

# ----------------------------------------------------------------------------
# PAYMENT GATEWAY (TINKOFF/SBER/YOOKASSA)
# ----------------------------------------------------------------------------

# Primary payment provider
PAYMENT_PROVIDER=tinkoff

# Tinkoff credentials
TINKOFF_TERMINAL_KEY=CHANGE_ME
TINKOFF_SECRET_KEY=CHANGE_ME

# Webhook URL for payment notifications
PAYMENT_WEBHOOK_URL=https://api.ctea.ru/webhooks/payment

# ----------------------------------------------------------------------------
# OAUTH / AUTHENTICATION
# ----------------------------------------------------------------------------

OAUTH_SERVER_URL=https://auth.manus.app
VITE_OAUTH_PORTAL_URL=https://auth.manus.app

# ----------------------------------------------------------------------------
# ANALYTICS & MONITORING
# ----------------------------------------------------------------------------

VITE_ANALYTICS_ENDPOINT=https://analytics.ctea.ru
VITE_ANALYTICS_WEBSITE_ID=CHANGE_ME

# Sentry error tracking (optional)
# SENTRY_DSN=https://xxx@sentry.io/xxx

# ----------------------------------------------------------------------------
# TELEGRAM BOT (OPTIONAL)
# ----------------------------------------------------------------------------

# TELEGRAM_BOT_TOKEN=CHANGE_ME
# TELEGRAM_WEBHOOK_URL=https://api.ctea.ru/webhooks/telegram

# ----------------------------------------------------------------------------
# STORAGE (S3-COMPATIBLE)
# ----------------------------------------------------------------------------

# S3_ENDPOINT=https://s3.example.com
# S3_ACCESS_KEY=CHANGE_ME
# S3_SECRET_KEY=CHANGE_ME
# S3_BUCKET=ctea-production

# ----------------------------------------------------------------------------
# RATE LIMITING
# ----------------------------------------------------------------------------

RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# ----------------------------------------------------------------------------
# LOGGING
# ----------------------------------------------------------------------------

LOG_LEVEL=info
LOG_FORMAT=json

# ============================================================================
# SECURITY CHECKLIST (BEFORE DEPLOYMENT)
# ============================================================================
#
# [ ] All CHANGE_ME values have been replaced with actual credentials
# [ ] DATABASE_SSL=true is set
# [ ] DATABASE_SSL_REJECT_UNAUTHORIZED=true is set
# [ ] JWT_SECRET is at least 32 characters of random data
# [ ] SESSION_SECRET is at least 32 characters of random data
# [ ] All API keys are production keys (not test/sandbox)
# [ ] PAYMENT_WEBHOOK_URL points to production domain
# [ ] SSL certificates are valid and not self-signed
# [ ] Redis is password-protected
# [ ] Database user has minimal required permissions
#
# ============================================================================
